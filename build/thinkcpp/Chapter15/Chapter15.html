<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>File Input/Output and apmatrixes &#8212; How to Think Like a Computer Scientist - C++</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/accessibility.css?v=DB047029" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/handsontable@7.2.2/dist/handsontable.full.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/CodeChat.css" />
    <link rel="stylesheet" type="text/css" href="../_static/matrixeq.css?v=58BC228F" />
    <link rel="stylesheet" type="text/css" href="../_static/webgldemo.css?v=B36B48D" />
    <link rel="stylesheet" type="text/css" href="../_static/webglinteractive.css?v=910DF1E1" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/presenter_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jquery-ui-1.10.3.custom.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/user-highlights.css" />
    <link rel="stylesheet" type="text/css" href="../_static/runestone-custom-sphinx-bootstrap.css?v=5.0.0" />
    <link rel="stylesheet" type="text/css" href="../_static/theme-overrides.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/jquery.highlight.js?v=F1C496C8"></script>
    <script src="../_static/sql-wasm.js?v=44FE0709"></script>
    <script src="https://cdn.jsdelivr.net/npm/handsontable@7.2.2/dist/handsontable.full.js"></script>
    <script src="../_static/animationbase.js?v=A043C3A7"></script>
    <script src="../_static/pytutor-embed.bundle.js?v=268B5C04"></script>
    <script src="../_static/matrixeq.js?v=D64CFA5A"></script>
    <script src="../_static/webglinteractive.js?v=2B768384"></script>
    <script src="../_static/FileSaver.min.js?v=8408C997"></script>
    <script src="../_static/Blob.js?v=AEC2447"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.emitter.bidi.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.emitter.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.fallbacks.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.messagestore.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.parser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.language.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@4.0.0-rc.2/build/vega.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@2.5.0/build/vega-lite.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@3.14.0/build/vega-embed.js"></script>
    <script src="../_static/runestone.js?v=5.0.0"></script>
    <script src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="../_static/jquery-fix.js"></script>
    <script src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script src="../_static/bootstrap-sphinx.js"></script>
    <script src="../_static/waypoints.min.js"></script>
    <script src="../_static/jquery.idle-timer.js"></script>
    <script src="../_static/processing-1.4.1.min.js"></script>
    <script src="../_static/jquery.hotkey.js"></script>
    <script src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <script src="../_static/presenter_mode.js?v=5.0.0"></script>
    <script src="../_static/theme.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  
    eBookConfig.useRunestoneServices = true;
    eBookConfig.host = 'http://127.0.0.1:8000' || 'http://127.0.0.1:8000';
    eBookConfig.app = eBookConfig.host+'/runestone';
    eBookConfig.course = 'thinkcpp';
    eBookConfig.basecourse = 'thinkcpp';
    eBookConfig.isLoggedIn = false;
  
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.python3 = true;
  eBookConfig.acDefaultLanguage = '' ? '' : 'python'
  eBookConfig.runestone_version = '';
  eBookConfig.jobehost = '';
  eBookConfig.proxyuri_runs = '';
  eBookConfig.proxyuri_files = '';
  eBookConfig.enable_chatcodes = false ? false : false;


</script>


<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar" aria-label="navbar toggle" class="visuallyhidden">toggle navbar</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        
          <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        
        <a class="navbar-brand" href="../index.html" aria-label="index-page">
          
          thinkcpp
        </a>
      </div>
    </div>



    <div class="navbar-collapse collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav navbar-right" >

        <li class="divider-vertical"></li>


        <!-- social media dropdown -->
        
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-globe" style="opacity: 0.9"><span aria-label="Social" class="visuallyhidden">Social</span></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHNwYJKoZIhvcNAQcEoIIHKDCCByQCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYAcrkqh1hn3lYqIpfXxNqe1T82EhXzCJGy1yMAmklpyZshyMkfDGe1Bhx+iwyGeoYRTTyphFmP+9M3NyO0+Q5XdHxgZPx/zYjjBxlZHgEV6jhE8bN2fHkkPf0VHfz0a0QQylQOPlKiOTZV7B37Jpk6yM47oVZ1tG/KNm0NkfmB76DELMAkGBSsOAwIaBQAwgbQGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIi0GmFfOlcjuAgZBbYOo9UO+CpMQa+PYqwsUmUnJvXIImeMeNI3KVTUx5Cfk9gNMo3WzPeiB5IqZo9nRAQ0mf1qL2ecLeB5tidM+lgBUhOxfj3/FecpnVFa0263gp4g+PLw8jzhvVRdUon1K3SeO1Rzh23fIRKwnrD6btt73uwtj0sl3tGd8qz+6GIcwPDdRk9VcUffiBJT/ZagKgggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xMzExMDMxMzQxMzFaMCMGCSqGSIb3DQEJBDEWBBRDJF8w+zsMr7FSk+pwinB5f5D4rzANBgkqhkiG9w0BAQEFAASBgHw1LMHpkpaqHIvDGdFE0eG+2mZlmMnUeDCBhQlbc7QMzFQYKTV94NfaebBO4PmNdADe1rq4WidSRZZbE7CzkX9IGENYnBTWY0hb2l0lGdGrJdGeWyV3ekg9WVaFMMumrekds96h3Cx7dGz2kWDzIai2iEXE/qoE+xpkyXAYZNV3-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li><!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'><span aria-label="Search" class="visuallyhidden">Search</span></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html' aria-label="index-page">Table of Contents</a></li>
            
            <li><a href='../genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <!-- user account dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"><span aria-label="User" class="visuallyhidden">User</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='/runestone/assignments/chooseAssignment.html'>Assignments</a></li>
            <li><a href='/runestone/assignments/practice'>Practice</a></li>
            <li class="divider"></li>
            
            <li><a href='/runestone/default/courses'>Change Course</a></li>
			      <li class="divider"></li>
            <li id="ip_dropdown_link"><a href='/runestone/admin/index'>Instructor's Page</a></li>
            
            <li><a href='/runestone/dashboard/studentreport'>Progress Page</a></li>
            <li class="divider"></li>
            
            <li><a href="/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="/runestone/default/user/register" id="registerlink">Register</a></li>
            
            <li class='loginout'><a href='#'>Login</a></li> <!-- correct link populated by addNavbarLoginLink() -->
			<!-- dark mode toggle -->
             <li><label class="theme-switch" for="checkbox">
					  <input type="checkbox" id="checkbox" onchange="switchTheme()" />
							<div class="slider round"></div>
					</label>Dark Mode</li>
			 </ul>
        </li>
        <!-- end user account dropdown -->
        
        <li class="divider-vertical"></li>
        <!-- <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li> -->

        <!-- <li class="dropdown">             -->
          <li id="scratch_ac_link" class="dropdown"><a href="javascript:ACFactory.toggleScratchActivecode()">
              <i class="glyphicon glyphicon-pencil" style="opacity:0.9;"><span aria-label="Scratch Activecode" class="visuallyhidden">Scratch Activecode</span></i></a></li>
        <!-- </li> -->

        <li class="divider-vertical"></li>

        
        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"><span aria-label="Help" class="visuallyhidden">Help</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='http://runestoneinteractive.org/pages/faq.html'>FAQ</a></li>
            <li><a href='https://runestone.academy/runestone/static/instructorguide/index.html'>Instructors Guide</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=thinkcpp&page=Chapter15'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>
      
      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          
          <li class="divider-vertical"></li>
        
        <!-- 
          

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

      </div> <!-- navbar -->







    </div> <!-- container -->
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content" role="main">
  
  <div class="section" id="file-input-output-and-apmatrixes">
<h1>File Input/Output and <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code>es<a class="headerlink" href="#file-input-output-and-apmatrixes" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we will develop a program that reads and writes files,
parses input, and demonstrates the <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code> class. We will also
implement a data structure called <code class="docutils literal notranslate"><span class="pre">Set</span></code> that expands automatically as
you add elements.</p>
<p>Aside from demonstrating all these features, the real purpose of the
program is to generate a two-dimensional table of the distances between
cities in the United States. The output is a table that looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Atlanta</span> <span class="mi">0</span>
<span class="n">Chicago</span> <span class="mi">700</span>     <span class="mi">0</span>
<span class="n">Boston</span>  <span class="mi">1100</span>    <span class="mi">1000</span>    <span class="mi">0</span>
<span class="n">Dallas</span>  <span class="mi">800</span>     <span class="mi">900</span>     <span class="mi">1750</span>    <span class="mi">0</span>
<span class="n">Denver</span>  <span class="mi">1450</span>    <span class="mi">1000</span>    <span class="mi">2000</span>    <span class="mi">800</span>     <span class="mi">0</span>
<span class="n">Detroit</span> <span class="mi">750</span>     <span class="mi">300</span>     <span class="mi">800</span>     <span class="mi">1150</span>    <span class="mi">1300</span>    <span class="mi">0</span>
<span class="n">Orlando</span> <span class="mi">400</span>     <span class="mi">1150</span>    <span class="mi">1300</span>    <span class="mi">1100</span>    <span class="mi">1900</span>    <span class="mi">1200</span>    <span class="mi">0</span>
<span class="n">Phoenix</span> <span class="mi">1850</span>    <span class="mi">1750</span>    <span class="mi">2650</span>    <span class="mi">1000</span>    <span class="mi">800</span>     <span class="mi">2000</span>    <span class="mi">2100</span>    <span class="mi">0</span>
<span class="n">Seattle</span> <span class="mi">2650</span>    <span class="mi">2000</span>    <span class="mi">3000</span>    <span class="mi">2150</span>    <span class="mi">1350</span>    <span class="mi">2300</span>    <span class="mi">3100</span>    <span class="mi">1450</span>    <span class="mi">0</span>
        <span class="n">Atlanta</span> <span class="n">Chicago</span> <span class="n">Boston</span>  <span class="n">Dallas</span>  <span class="n">Denver</span>  <span class="n">Detroit</span> <span class="n">Orlando</span> <span class="n">Phoenix</span> <span class="n">Seattle</span>
</pre></div>
</div>
<p>The diagonal elements are all zero because that is the distance from a
city to itself. Also, because the distance from A to B is the same as
the distance from B to A, there is no need to print the top half of the
matrix.</p>
<div class="section" id="streams">
<h2>Streams<a class="headerlink" href="#streams" title="Permalink to this headline">¶</a></h2>
<p>To get input from a file or send output to a file, you have to create an
<code class="docutils literal notranslate"><span class="pre">ifstream</span></code> object (for input files) or an <code class="docutils literal notranslate"><span class="pre">ofstream</span></code> object (for
output files). These objects are defined in the header file <code class="docutils literal notranslate"><span class="pre">fstream</span></code>,
which you have to include.</p>
<p>A <strong>stream</strong> is an abstract object that represents the flow of data from
a source like the keyboard or a file to a destination like the screen or
a file.</p>
<p>We have already worked with two streams: <code class="docutils literal notranslate"><span class="pre">cin</span></code>, which has type
<code class="docutils literal notranslate"><span class="pre">istream</span></code>, and <code class="docutils literal notranslate"><span class="pre">cout</span></code>, which has type <code class="docutils literal notranslate"><span class="pre">ostream</span></code>. <code class="docutils literal notranslate"><span class="pre">cin</span></code>
represents the flow of data from the keyboard to the program. Each time
the program uses the <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> operator or the <code class="docutils literal notranslate"><span class="pre">getline</span></code> function, it
removes a piece of data from the input stream.</p>
<p>Similarly, when the program uses the <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> operator on an <code class="docutils literal notranslate"><span class="pre">ostream</span></code>,
it adds a datum to the outgoing stream.</p>
</div>
<div class="section" id="file-input">
<span id="finput"></span><h2>File input<a class="headerlink" href="#file-input" title="Permalink to this headline">¶</a></h2>
<p>To get data from a file, we have to create a stream that flows from the
file into the program. We can do that using the <code class="docutils literal notranslate"><span class="pre">ifstream</span></code>
constructor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ifstream</span> <span class="n">infile</span> <span class="p">(</span><span class="s2">&quot;file-name&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>The argument for this constructor is a string that contains the name of
the file you want to open. The result is an object named <code class="docutils literal notranslate"><span class="pre">infile</span></code> that
supports all the same operations as <code class="docutils literal notranslate"><span class="pre">cin</span></code>, including <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> and
<code class="docutils literal notranslate"><span class="pre">getline</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">x</span><span class="p">;</span>
<span class="n">apstring</span> <span class="n">line</span><span class="p">;</span>

<span class="n">infile</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>               <span class="o">//</span> <span class="n">get</span> <span class="n">a</span> <span class="n">single</span> <span class="n">integer</span> <span class="ow">and</span> <span class="n">store</span> <span class="ow">in</span> <span class="n">x</span>
<span class="n">getline</span> <span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>    <span class="o">//</span> <span class="n">get</span> <span class="n">a</span> <span class="n">whole</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">store</span> <span class="ow">in</span> <span class="n">line</span>
</pre></div>
</div>
<p>If we know ahead of time how much data is in a file, it is
straightforward to write a loop that reads the entire file and then
stops. More often, though, we want to read the entire file, but don’t
know how big it is.</p>
<p>There are member functions for <code class="docutils literal notranslate"><span class="pre">ifstreams</span></code> that check the status of
the input stream; they are called <code class="docutils literal notranslate"><span class="pre">good</span></code>, <code class="docutils literal notranslate"><span class="pre">eof</span></code>, <code class="docutils literal notranslate"><span class="pre">fail</span></code> and
<code class="docutils literal notranslate"><span class="pre">bad</span></code>. We will use <code class="docutils literal notranslate"><span class="pre">good</span></code> to make sure the file was opened
successfully and <code class="docutils literal notranslate"><span class="pre">eof</span></code> to detect the “end of file.”</p>
<p>Whenever you get data from an input stream, you don’t know whether the
attempt succeeded until you check. If the return value from <code class="docutils literal notranslate"><span class="pre">eof</span></code> is
<code class="docutils literal notranslate"><span class="pre">true</span></code> then we have reached the end of the file and we know that the
last attempt failed. Here is a program that reads lines from a file and
displays them on the screen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apstring</span> <span class="n">fileName</span> <span class="o">=</span> <span class="o">...</span><span class="p">;</span>
<span class="n">ifstream</span> <span class="n">infile</span> <span class="p">(</span><span class="n">fileName</span><span class="o">.</span><span class="n">c_str</span><span class="p">());</span>

<span class="k">if</span> <span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">good</span><span class="p">()</span> <span class="o">==</span> <span class="n">false</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Unable to open the file named &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">fileName</span><span class="p">;</span>
  <span class="n">exit</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">while</span> <span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">getline</span> <span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">eof</span><span class="p">())</span> <span class="k">break</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">line</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">c_str</span></code> converts an <code class="docutils literal notranslate"><span class="pre">apstring</span></code> to a native C string.
Because the <code class="docutils literal notranslate"><span class="pre">ifstream</span></code> constructor expects a C string as an argument,
we have to convert the <code class="docutils literal notranslate"><span class="pre">apstring</span></code>.</p>
<p>Immediately after opening the file, we invoke the <code class="docutils literal notranslate"><span class="pre">good</span></code> function. The
return value is <code class="docutils literal notranslate"><span class="pre">false</span></code> if the system could not open the file, most
likely because it does not exist, or you do not have permission to read
it.</p>
<p>The statement <code class="docutils literal notranslate"><span class="pre">while(true)</span></code> is an idiom for an infinite loop. Usually
there will be a <code class="docutils literal notranslate"><span class="pre">break</span></code> statement somewhere in the loop so that the
program does not really run forever (although some programs do). In this
case, the <code class="docutils literal notranslate"><span class="pre">break</span></code> statement allows us to exit the loop as soon as we
detect the end of file.</p>
<p>It is important to exit the loop between the input statement and the
output statement, so that when <code class="docutils literal notranslate"><span class="pre">getline</span></code> fails at the end of the file,
we do not output the invalid data in <code class="docutils literal notranslate"><span class="pre">line</span></code>.</p>
</div>
<div class="section" id="file-output">
<h2>File output<a class="headerlink" href="#file-output" title="Permalink to this headline">¶</a></h2>
<p>Sending output to a file is similar. For example, we could modify the
previous program to copy lines from one file to another.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ifstream</span> <span class="n">infile</span> <span class="p">(</span><span class="s2">&quot;input-file&quot;</span><span class="p">);</span>
<span class="n">ofstream</span> <span class="n">outfile</span> <span class="p">(</span><span class="s2">&quot;output-file&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">good</span><span class="p">()</span> <span class="o">==</span> <span class="n">false</span> <span class="o">||</span> <span class="n">outfile</span><span class="o">.</span><span class="n">good</span><span class="p">()</span> <span class="o">==</span> <span class="n">false</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Unable to open one of the files.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">exit</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">while</span> <span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">getline</span> <span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">eof</span><span class="p">())</span> <span class="k">break</span><span class="p">;</span>
  <span class="n">outfile</span> <span class="o">&lt;&lt;</span> <span class="n">line</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="parsing-input">
<span id="parsing"></span><h2>Parsing input<a class="headerlink" href="#parsing-input" title="Permalink to this headline">¶</a></h2>
<p>In Section <a class="reference external" href="#formal">[formal]</a> I defined “parsing” as the process of
analyzing the structure of a sentence in a natural language or a
statement in a formal language. For example, the compiler has to parse
your program before it can translate it into machine language.</p>
<p>In addition, when you read input from a file or from the keyboard you
often have to parse it in order to extract the information you want and
detect errors.</p>
<p>For example, I have a file called <code class="docutils literal notranslate"><span class="pre">distances</span></code> that contains
information about the distances between major cities in the United
States. I got this information from a randomly-chosen web page</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">jaring</span><span class="o">.</span><span class="n">my</span><span class="o">/</span><span class="n">usiskl</span><span class="o">/</span><span class="n">usa</span><span class="o">/</span><span class="n">distance</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>so it may be wildly inaccurate, but that doesn’t matter. The format of
the file looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Chicago&quot;</span>       <span class="mi">700</span>
<span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Boston&quot;</span>        <span class="mi">1</span><span class="p">,</span><span class="mi">100</span>
<span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Chicago&quot;</span>       <span class="mi">700</span>
<span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Dallas&quot;</span>        <span class="mi">800</span>
<span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Denver&quot;</span>        <span class="mi">1</span><span class="p">,</span><span class="mi">450</span>
<span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Detroit&quot;</span>       <span class="mi">750</span>
<span class="s2">&quot;Atlanta&quot;</span>       <span class="s2">&quot;Orlando&quot;</span>       <span class="mi">400</span>
</pre></div>
</div>
<p>Each line of the file contains the names of two cities in quotation
marks and the distance between them in miles. The quotation marks are
useful because they make it easy to deal with names that have more than
one word, like “San Francisco.”</p>
<p>By searching for the quotation marks in a line of input, we can find the
beginning and end of each city name. Searching for special characters
like quotation marks can be a little awkward, though, because the
quotation mark is a special character in C++, used to identify string
values.</p>
<p>If we want to find the first appearance of a quotation mark, we have to
write something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The argument here looks like a mess, but it represents a single
character, a double quotation mark. The outermost single-quotes indicate
that this is a character value, as usual. The backslash (<code class="docutils literal notranslate"><span class="pre">\</span></code>)
indicates that we want to treat the next character literally. The
sequence <code class="docutils literal notranslate"><span class="pre">\&quot;</span></code> represents a quotation mark; the sequence <code class="docutils literal notranslate"><span class="pre">\'</span></code>
represents a single-quote. Interestingly, the sequence <code class="docutils literal notranslate"><span class="pre">\\</span></code> represents
a single backslash. The first backslash indicates that we should take
the second backslash seriously.</p>
<p>Parsing input lines consists of finding the beginning and end of each
city name and using the <code class="docutils literal notranslate"><span class="pre">substr</span></code> function to extract the cities and
distance. <code class="docutils literal notranslate"><span class="pre">substr</span></code> is an <code class="docutils literal notranslate"><span class="pre">apstring</span></code> member function; it takes two
arguments, the starting index of the substring and the length.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">processLine</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">line</span><span class="p">)</span>
<span class="p">{</span>
  <span class="o">//</span> <span class="n">the</span> <span class="n">character</span> <span class="n">we</span> <span class="n">are</span> <span class="n">looking</span> <span class="k">for</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">quotation</span> <span class="n">mark</span>
  <span class="n">char</span> <span class="n">quote</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">store</span> <span class="n">the</span> <span class="n">indices</span> <span class="n">of</span> <span class="n">the</span> <span class="n">quotation</span> <span class="n">marks</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">vector</span>
  <span class="n">apvector</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">quoteIndex</span> <span class="p">(</span><span class="mi">4</span><span class="p">);</span>

  <span class="o">//</span> <span class="n">find</span> <span class="n">the</span> <span class="n">first</span> <span class="n">quotation</span> <span class="n">mark</span> <span class="n">using</span> <span class="n">the</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">find</span>
  <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span> <span class="p">(</span><span class="n">quote</span><span class="p">);</span>

  <span class="o">//</span> <span class="n">find</span> <span class="n">the</span> <span class="n">other</span> <span class="n">quotation</span> <span class="n">marks</span> <span class="n">using</span> <span class="n">the</span> <span class="n">find</span> <span class="kn">from</span> <span class="nn">Chapter</span> <span class="mi">7</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">quoteIndex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span> <span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">quote</span><span class="p">,</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="k">break</span> <span class="n">the</span> <span class="n">line</span> <span class="n">up</span> <span class="n">into</span> <span class="n">substrings</span>
  <span class="nb">int</span> <span class="n">len1</span> <span class="o">=</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">city1</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">substr</span> <span class="p">(</span><span class="n">quoteIndex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">len1</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">len2</span> <span class="o">=</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">city2</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">substr</span> <span class="p">(</span><span class="n">quoteIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">len2</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">len3</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">-</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">distString</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">substr</span> <span class="p">(</span><span class="n">quoteIndex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">len3</span><span class="p">);</span>

  <span class="o">//</span> <span class="n">output</span> <span class="n">the</span> <span class="n">extracted</span> <span class="n">information</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">city1</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">city2</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">distString</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Of course, just displaying the extracted information is not exactly what
we want, but it is a good starting place.</p>
</div>
<div class="section" id="parsing-numbers">
<h2>Parsing numbers<a class="headerlink" href="#parsing-numbers" title="Permalink to this headline">¶</a></h2>
<p>The next task is to convert the numbers in the file from strings to
integers. When people write large numbers, they often use commas to
group the digits, as in 1,750. Most of the time when computers write
large numbers, they don’t include commas, and the built-in functions for
reading numbers usually can’t handle them. That makes the conversion a
little more difficult, but it also provides an opportunity to write a
comma-stripping function, so that’s ok. Once we get rid of the commas,
we can use the library function <code class="docutils literal notranslate"><span class="pre">atoi</span></code> to convert to integer. <code class="docutils literal notranslate"><span class="pre">atoi</span></code>
is defined in the header file <code class="docutils literal notranslate"><span class="pre">cstdlib</span></code>.</p>
<p>To get rid of the commas, one option is to traverse the string and check
whether each character is a digit. If so, we add it to the result
string. At the end of the loop, the result string contains all the
digits from the original string, in order.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">convertToInt</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">apstring</span> <span class="n">digitString</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="o">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isdigit</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="p">{</span>
      <span class="n">digitString</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">atoi</span> <span class="p">(</span><span class="n">digitString</span><span class="o">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">digitString</span></code> is an example of an <strong>accumulator</strong>. It is
similar to the counter we saw in Section <a class="reference external" href="#loopcount">[loopcount]</a>,
except that instead of getting incremented, it gets accumulates one new
character at a time, using string concatentation.</p>
<p>The expression</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">digitString</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">digitString</span> <span class="o">=</span> <span class="n">digitString</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</pre></div>
</div>
<p>Both statements add a single character onto the end of the existing
string.</p>
<p>Since <code class="docutils literal notranslate"><span class="pre">atoi</span></code> takes a C string as a parameter, we have to convert
<code class="docutils literal notranslate"><span class="pre">digitString</span></code> to a C string before passing it as an argument.</p>
</div>
<div class="section" id="the-set-data-structure">
<h2>The <code class="docutils literal notranslate"><span class="pre">Set</span></code> data structure<a class="headerlink" href="#the-set-data-structure" title="Permalink to this headline">¶</a></h2>
<p>A data structure is a container for grouping a collection of data into a
single object. We have seen some examples already, including
<code class="docutils literal notranslate"><span class="pre">apstring</span></code>s, which are collections of characters, and
<code class="docutils literal notranslate"><span class="pre">apvector</span></code>s which are collections on any type.</p>
<p>An ordered set is a collection of items with two defining properties:</p>
<dl class="simple">
<dt>Ordering:</dt><dd><p>The elements of the set have indices associated with them. We can use
these indices to identify elements of the set.</p>
</dd>
<dt>Uniqueness:</dt><dd><p>No element appears in the set more than once. If you try to add an
element to a set, and it already exists, there is no effect.</p>
</dd>
</dl>
<p>In addition, our implementation of an ordered set will have the
following property:</p>
<dl class="simple">
<dt>Arbitrary size:</dt><dd><p>As we add elements to the set, it expands to make room for new
elements.</p>
</dd>
</dl>
<p>Both <code class="docutils literal notranslate"><span class="pre">apstring</span></code>s and <code class="docutils literal notranslate"><span class="pre">apvector</span></code>s have an ordering; every element
has an index we can use to identify it. Both none of the data structures
we have seen so far have the properties of uniqueness or arbitrary size.</p>
<p>To achieve uniqueness, we have to write an <code class="docutils literal notranslate"><span class="pre">add</span></code> function that
searches the set to see if it already exists. To make the set expand as
elements are added, we can take advantage of the <code class="docutils literal notranslate"><span class="pre">resize</span></code> function on
<code class="docutils literal notranslate"><span class="pre">apvector</span></code>s.</p>
<p>Here is the beginning of a class definition for a <code class="docutils literal notranslate"><span class="pre">Set</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Set</span> <span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
  <span class="n">apvector</span><span class="o">&lt;</span><span class="n">apstring</span><span class="o">&gt;</span> <span class="n">elements</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">numElements</span><span class="p">;</span>

<span class="n">public</span><span class="p">:</span>
  <span class="n">Set</span> <span class="p">(</span><span class="nb">int</span> <span class="n">n</span><span class="p">);</span>

  <span class="nb">int</span> <span class="n">getNumElements</span> <span class="p">()</span> <span class="n">const</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">getElement</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">find</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">add</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">);</span>
<span class="p">};</span>

<span class="n">Set</span><span class="p">::</span><span class="n">Set</span> <span class="p">(</span><span class="nb">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">apvector</span><span class="o">&lt;</span><span class="n">apstring</span><span class="o">&gt;</span> <span class="n">temp</span> <span class="p">(</span><span class="n">n</span><span class="p">);</span>
  <span class="n">elements</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
  <span class="n">numElements</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The instance variables are an <code class="docutils literal notranslate"><span class="pre">apvector</span></code> of strings and an integer
that keeps track of how many elements there are in the set. Keep in mind
that the number of elements in the set, <code class="docutils literal notranslate"><span class="pre">numElements</span></code>, is not the same
thing as the size of the <code class="docutils literal notranslate"><span class="pre">apvector</span></code>. Usually it will be smaller.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Set</span></code> constructor takes a single parameter, which is the initial
size of the <code class="docutils literal notranslate"><span class="pre">apvector</span></code>. The initial number of elements is always zero.</p>
<p><code class="docutils literal notranslate"><span class="pre">getNumElements</span></code> and <code class="docutils literal notranslate"><span class="pre">getElement</span></code> are accessor functions for the
instance variables, which are private. <code class="docutils literal notranslate"><span class="pre">numElements</span></code> is a read-only
variable, so we provide a <code class="docutils literal notranslate"><span class="pre">get</span></code> function but not a <code class="docutils literal notranslate"><span class="pre">set</span></code> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">Set</span><span class="p">::</span><span class="n">getNumElements</span> <span class="p">()</span> <span class="n">const</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="n">numElements</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Why do we have to prevent client programs from changing
<code class="docutils literal notranslate"><span class="pre">getNumElements</span></code>? What are the invariants for this type, and how could
a client program break an invariant. As we look at the rest of the
<code class="docutils literal notranslate"><span class="pre">Set</span></code> member function, see if you can convince yourself that they all
maintain the invariants.</p>
<p>When we use the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator to access the <code class="docutils literal notranslate"><span class="pre">apvector</span></code>, it checks to
make sure the index is greater than or equal to zero and less than the
length of the <code class="docutils literal notranslate"><span class="pre">apvector</span></code>. To access the elements of a set, though, we
need to check a stronger condition. The index has to be less than the
number of elements, which might be smaller than the length of the
<code class="docutils literal notranslate"><span class="pre">apvector</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apstring</span> <span class="n">Set</span><span class="p">::</span><span class="n">getElement</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="p">)</span> <span class="n">const</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numElements</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Set index out of range.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">exit</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">getElement</span></code> gets an index that is out of range, it prints an error
message (not the most useful message, I admit), and exits.</p>
<p>The interesting functions are <code class="docutils literal notranslate"><span class="pre">find</span></code> and <code class="docutils literal notranslate"><span class="pre">add</span></code>. By now, the pattern
for traversing and searching should be old hat:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">Set</span><span class="p">::</span><span class="n">find</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span> <span class="n">const</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">numElements</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">)</span> <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So that leaves us with <code class="docutils literal notranslate"><span class="pre">add</span></code>. Often the return type for something like
<code class="docutils literal notranslate"><span class="pre">add</span></code> would be void, but in this case it might be useful to make it
return the index of the element.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">Set</span><span class="p">::</span><span class="n">add</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
  <span class="o">//</span> <span class="k">if</span> <span class="n">the</span> <span class="n">element</span> <span class="ow">is</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">set</span><span class="p">,</span> <span class="k">return</span> <span class="n">its</span> <span class="n">index</span>
  <span class="nb">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">find</span> <span class="p">(</span><span class="n">s</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="n">index</span><span class="p">;</span>

  <span class="o">//</span> <span class="k">if</span> <span class="n">the</span> <span class="n">apvector</span> <span class="ow">is</span> <span class="n">full</span><span class="p">,</span> <span class="n">double</span> <span class="n">its</span> <span class="n">size</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">numElements</span> <span class="o">==</span> <span class="n">elements</span><span class="o">.</span><span class="n">length</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">elements</span><span class="o">.</span><span class="n">resize</span> <span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">add</span> <span class="n">the</span> <span class="n">new</span> <span class="n">elements</span> <span class="ow">and</span> <span class="k">return</span> <span class="n">its</span> <span class="n">index</span>
  <span class="n">index</span> <span class="o">=</span> <span class="n">numElements</span><span class="p">;</span>
  <span class="n">elements</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span>
  <span class="n">numElements</span><span class="o">++</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">index</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The tricky thing here is that <code class="docutils literal notranslate"><span class="pre">numElements</span></code> is used in two ways. It is
the number of elements in the set, of course, but it is also the index
of the next element to be added.</p>
<p>It takes a minute to convince yourself that that works, but consider
this: when the number of elements is zero, the index of the next element
is 0. When the number of elements is equal to the length of the
<code class="docutils literal notranslate"><span class="pre">apvector</span></code>, that means that the vector is full, and we have to
allocate more space (using <code class="docutils literal notranslate"><span class="pre">resize</span></code>) before we can add the new
element.</p>
<p>Here is a state diagram showing a <code class="docutils literal notranslate"><span class="pre">Set</span></code> object that initially contains
space for 2 elements.</p>
<p>Now we can use the <code class="docutils literal notranslate"><span class="pre">Set</span></code> class to keep track of the cities we find in
the file. In <code class="docutils literal notranslate"><span class="pre">main</span></code> we create the <code class="docutils literal notranslate"><span class="pre">Set</span></code> with an initial size of 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Set</span> <span class="n">cities</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>Then in <code class="docutils literal notranslate"><span class="pre">processLine</span></code> we add both cities to the <code class="docutils literal notranslate"><span class="pre">Set</span></code> and store the
index that gets returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">index1</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">city1</span><span class="p">);</span>
<span class="nb">int</span> <span class="n">index2</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">city2</span><span class="p">);</span>
</pre></div>
</div>
<p>I modified <code class="docutils literal notranslate"><span class="pre">processLine</span></code> to take the <code class="docutils literal notranslate"><span class="pre">cities</span></code> object as a second
parameter.</p>
</div>
<div class="section" id="apmatrix">
<h2><code class="docutils literal notranslate"><span class="pre">apmatrix</span></code><a class="headerlink" href="#apmatrix" title="Permalink to this headline">¶</a></h2>
<p>An <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code> is similar to an <code class="docutils literal notranslate"><span class="pre">apvector</span></code> except it is
two-dimensional. Instead of a length, it has two dimensions, called
<code class="docutils literal notranslate"><span class="pre">numrows</span></code> and <code class="docutils literal notranslate"><span class="pre">numcols</span></code>, for “number of rows” and “number of
columns.”</p>
<p>Each element in the matrix is indentified by two indices; one specifies
the row number, the other the column number.</p>
<p>To create a matrix, there are four constructors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apmatrix</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="n">m1</span><span class="p">;</span>
<span class="n">apmatrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">m2</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">apmatrix</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span> <span class="n">m3</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
<span class="n">apmatrix</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span> <span class="n">m4</span> <span class="p">(</span><span class="n">m3</span><span class="p">);</span>
</pre></div>
</div>
<p>The first is a do-nothing constructor that makes a matrix with both
dimensions 0. The second takes two integers, which are the initial
number of rows and columns, in that order. The third is the same as the
second, except that it takes an additional parameter that is used to
initialized the elements of the matrix. The fourth is a copy constructor
that takes another <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code> as a parameter.</p>
<p>Just as with <code class="docutils literal notranslate"><span class="pre">apvectors</span></code>, we can make <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code>es with any type
of elements (including <code class="docutils literal notranslate"><span class="pre">apvector</span></code>s, and even <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code>es).</p>
<p>To access the elements of a matrix, we use the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator to
specify the row and column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">m3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">m2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</pre></div>
</div>
<p>If we try to access an element that is out of range, the program prints
an error message and quits.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">numrows</span></code> and <code class="docutils literal notranslate"><span class="pre">numcols</span></code> functions get the number of rows and
columns. Remember that the row indices run from 0 to <code class="docutils literal notranslate"><span class="pre">numrows()</span> <span class="pre">-1</span></code>
and the column indices run from 0 to <code class="docutils literal notranslate"><span class="pre">numcols()</span> <span class="pre">-1</span></code>.</p>
<p>The usual way to traverse a matrix is with a nested loop. This loop sets
each element of the matrix to the sum of its two indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="o">.</span><span class="n">numrows</span><span class="p">();</span> <span class="n">row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="o">.</span><span class="n">numcols</span><span class="p">();</span> <span class="n">col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m2</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This loop prints each row of the matrix with tabs between the elements
and newlines between the rows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="o">.</span><span class="n">numrows</span><span class="p">();</span> <span class="n">row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="o">.</span><span class="n">numcols</span><span class="p">();</span> <span class="n">col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m2</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="a-distance-matrix">
<h2>A distance matrix<a class="headerlink" href="#a-distance-matrix" title="Permalink to this headline">¶</a></h2>
<p>Finally, we are ready to put the data from the file into a matrix.
Specifically, the matrix will have one row and one column for each city.</p>
<p>We’ll create the matrix in <code class="docutils literal notranslate"><span class="pre">main</span></code>, with plenty of space to spare:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apmatrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">distances</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>Inside <code class="docutils literal notranslate"><span class="pre">processLine</span></code>, we add new information to the matrix by getting
the indices of the two cities from the <code class="docutils literal notranslate"><span class="pre">Set</span></code> and using them as matrix
indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">convertToInt</span> <span class="p">(</span><span class="n">distString</span><span class="p">);</span>
<span class="nb">int</span> <span class="n">index1</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">city1</span><span class="p">);</span>
<span class="nb">int</span> <span class="n">index2</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">city2</span><span class="p">);</span>

<span class="n">distances</span><span class="p">[</span><span class="n">index1</span><span class="p">][</span><span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="p">;</span>
<span class="n">distances</span><span class="p">[</span><span class="n">index2</span><span class="p">][</span><span class="n">index1</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="p">;</span>
</pre></div>
</div>
<p>Finally, in <code class="docutils literal notranslate"><span class="pre">main</span></code> we can print the information in a human-readable
form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cities</span><span class="o">.</span><span class="n">getNumElements</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">cities</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cities</span><span class="o">.</span><span class="n">getNumElements</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">cities</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>This code produces the output shown at the beginning of the chapter. The
original data is available from this book’s web page.</p>
</div>
<div class="section" id="a-proper-distance-matrix">
<h2>A proper distance matrix<a class="headerlink" href="#a-proper-distance-matrix" title="Permalink to this headline">¶</a></h2>
<p>Although this code works, it is not as well organized as it should be.
Now that we have written a prototype, we are in a good position to
evaluate the design and improve it.</p>
<p>What are some of the problems with the existing code?</p>
<ol class="arabic simple">
<li><p>We did not know ahead of time how big to make the distance matrix, so
we chose an arbitrary large number (50) and made it a fixed size. It
would be better to allow the distance matrix to expand in the same
way a <code class="docutils literal notranslate"><span class="pre">Set</span></code> does. The <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code> class has a function called
<code class="docutils literal notranslate"><span class="pre">resize</span></code> that makes this possible.</p></li>
<li><p>The data in the distance matrix is not well-encapsulated. We have to
pass the set of city names and the matrix itself as arguments to
<code class="docutils literal notranslate"><span class="pre">processLine</span></code>, which is awkward. Also, use of the distance matrix
is error prone because we have not provided accessor functions that
perform error-checking. It might be a good idea to take the <code class="docutils literal notranslate"><span class="pre">Set</span></code>
of city names and the <code class="docutils literal notranslate"><span class="pre">apmatrix</span></code> of distances, and combine them
into a single object called a <code class="docutils literal notranslate"><span class="pre">DistMatrix</span></code>.</p></li>
</ol>
<p>Here is a draft of what the header for a <code class="docutils literal notranslate"><span class="pre">DistMatrix</span></code> might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DistMatrix</span> <span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
  <span class="n">Set</span> <span class="n">cities</span><span class="p">;</span>
  <span class="n">apmatrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">distances</span><span class="p">;</span>

<span class="n">public</span><span class="p">:</span>
  <span class="n">DistMatrix</span> <span class="p">(</span><span class="nb">int</span> <span class="n">rows</span><span class="p">);</span>

  <span class="n">void</span> <span class="n">add</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">city1</span><span class="p">,</span> <span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">city2</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dist</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">distance</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">distance</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">city1</span><span class="p">,</span> <span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">city2</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">cityName</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">numCities</span> <span class="p">()</span> <span class="n">const</span><span class="p">;</span>
  <span class="n">void</span> <span class="nb">print</span> <span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Using this interface simplifies <code class="docutils literal notranslate"><span class="pre">main</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;fstream&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>


<span class="nb">int</span> <span class="n">main</span> <span class="p">()</span>
<span class="p">{</span>
  <span class="n">apstring</span> <span class="n">line</span><span class="p">;</span>
  <span class="n">ifstream</span> <span class="n">infile</span> <span class="p">(</span><span class="s2">&quot;distances&quot;</span><span class="p">);</span>
  <span class="n">DistMatrix</span> <span class="n">distances</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">getline</span> <span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">eof</span><span class="p">())</span> <span class="k">break</span><span class="p">;</span>
    <span class="n">processLine</span> <span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">distances</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">distances</span><span class="o">.</span><span class="n">print</span> <span class="p">();</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It also simplifies <code class="docutils literal notranslate"><span class="pre">processLine</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">processLine</span> <span class="p">(</span><span class="n">const</span> <span class="n">apstring</span><span class="o">&amp;</span> <span class="n">line</span><span class="p">,</span> <span class="n">DistMatrix</span><span class="o">&amp;</span> <span class="n">distances</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">char</span> <span class="n">quote</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">;</span>
  <span class="n">apvector</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">quoteIndex</span> <span class="p">(</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span> <span class="p">(</span><span class="n">quote</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">quoteIndex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span> <span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">quote</span><span class="p">,</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="k">break</span> <span class="n">the</span> <span class="n">line</span> <span class="n">up</span> <span class="n">into</span> <span class="n">substrings</span>
  <span class="nb">int</span> <span class="n">len1</span> <span class="o">=</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">city1</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">substr</span> <span class="p">(</span><span class="n">quoteIndex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">len1</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">len2</span> <span class="o">=</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">city2</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">substr</span> <span class="p">(</span><span class="n">quoteIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">len2</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">len3</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">-</span> <span class="n">quoteIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">apstring</span> <span class="n">distString</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">substr</span> <span class="p">(</span><span class="n">quoteIndex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">len3</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">convertToInt</span> <span class="p">(</span><span class="n">distString</span><span class="p">);</span>

  <span class="o">//</span> <span class="n">add</span> <span class="n">the</span> <span class="n">new</span> <span class="n">datum</span> <span class="n">to</span> <span class="n">the</span> <span class="n">distances</span> <span class="n">matrix</span>
  <span class="n">distances</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">city1</span><span class="p">,</span> <span class="n">city2</span><span class="p">,</span> <span class="n">distance</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>I will leave it as an exercise to you to implement the member functions
of <code class="docutils literal notranslate"><span class="pre">DistMatrix</span></code>.</p>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>ordered set:</dt><dd><p>A data structure in which every element appears only once and every
element has an index that identifies it.</p>
</dd>
<dt>stream:</dt><dd><p>A data structure that represents a “flow” or sequence of data items
from one place to another. In C++ streams are used for input and
output.</p>
</dd>
<dt>accumulator:</dt><dd><p>A variable used inside a loop to accumulate a result, often by
getting something added or concatenated during each iteration.</p>
</dd>
</dl>
</div>
</div>


  <div id=scprogresscontainer>
    You have attempted <span id=scprogresstotal></span> of <span id=scprogressposs></span> activities on this page <div id="subchapterprogress"></div>
  </div>
  
      

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});

</script>

<script>
	function mouseOverPrev() {
		document.getElementById("relations-prev").style.opacity=1;
	}

	function mouseOutPrev() {
		document.getElementById("relations-prev").style.opacity=0.4;
	}
	function mouseOverNext() {
		document.getElementById("relations-next").style.opacity=1;
	}

	function mouseOutNext() {
		document.getElementById("relations-next").style.opacity=0.4;
	}
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      
      <span id='numuserspan'></span><span class='loggedinuser'></span>
      
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020 - Based on How to Think Like a Computer Scientist.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> .
    </p>
  </div>
</footer>




<script> getSwitch(); </script>


  </body>
</html>